<div class="space-y-6">
            <!-- Model Configuration -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200">
                <label class="block text-sm font-medium text-gray-700 mb-2">üèóÔ∏è Select Model Size to Fine-tune</label>
                <select id="q4-model-size" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="small" selected>Small Model (1.3B parameters)</option>
                    <option value="medium">Medium Model (7B parameters)</option>
                    <option value="large">Large Model (13B parameters)</option>
                    <option value="xl">XL Model (70B parameters)</option>
                </select>
                <p class="text-xs text-blue-700 font-medium mt-2 bg-blue-100 px-2 py-1 rounded">üëÜ See how memory requirements change with model size!</p>
            </div>
            
            <!-- Fine-tuning Method Selection -->
            <div class="bg-white border border-gray-200 rounded-lg p-4">
                <label class="block text-sm font-medium text-gray-700 mb-3">üéØ Choose Fine-tuning Method</label>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <label class="cursor-pointer">
                        <input type="radio" name="q4-method" value="full" class="sr-only">
                        <div class="border-2 border-green-200 rounded-lg p-3 hover:border-green-400 hover:bg-green-50 transition-colors">
                            <div class="font-medium text-green-900">Full Fine-tuning</div>
                            <div class="text-xs text-green-700">Maximum Flexibility</div>
                            <div class="text-xs text-green-600 mt-1">Updates all parameters</div>
                        </div>
                    </label>
                    
                    <label class="cursor-pointer">
                        <input type="radio" name="q4-method" value="lora" class="sr-only" checked>
                        <div class="border-2 border-purple-200 rounded-lg p-3 hover:border-purple-400 hover:bg-purple-50 transition-colors">
                            <div class="font-medium text-purple-900">LoRA</div>
                            <div class="text-xs text-purple-700">Efficient</div>
                            <div class="text-xs text-purple-600 mt-1">Low-rank adapters</div>
                        </div>
                    </label>
                    
                    <label class="cursor-pointer">
                        <input type="radio" name="q4-method" value="qlora" class="sr-only">
                        <div class="border-2 border-orange-200 rounded-lg p-3 hover:border-orange-400 hover:bg-orange-50 transition-colors">
                            <div class="font-medium text-orange-900">QLoRA</div>
                            <div class="text-xs text-orange-700">Ultra Efficient</div>
                            <div class="text-xs text-orange-600 mt-1">LoRA + Quantization</div>
                        </div>
                    </label>
                </div>
                <!-- Adapter / Precision Controls -->
                <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-xs text-gray-600 mb-1">Adapter rank (r)</label>
                        <select id="q4-rank" class="w-full px-2 py-1.5 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="4">r = 4 (small)</option>
                            <option value="8" selected>r = 8 (balanced)</option>
                            <option value="16">r = 16</option>
                            <option value="32">r = 32 (large)</option>
                        </select>
                    </div>
                    <div id="q4-quant-wrapper">
                        <label class="block text-xs text-gray-600 mb-1">Quantization (base model)</label>
                        <select id="q4-quant" class="w-full px-2 py-1.5 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="4" selected>4-bit NF4 (QLoRA)</option>
                            <option value="8">8-bit (LLM.int8)</option>
                            <option value="16">16-bit (no quantization)</option>
                        </select>
                        <p id="q4-quant-note" class="text-[11px] text-gray-500 mt-1">Only applies when QLoRA is selected</p>
                    </div>
                </div>
            </div>

            <!-- Quick Examples -->
            <div class="flex flex-wrap gap-2">
                <span class="text-sm font-medium text-gray-700">üí° Quick Examples:</span>
                <button id="q4-example-btn" class="text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded hover:bg-indigo-200 transition-colors">Try: Consumer GPU scenario</button>
            </div>
            
            <!-- Visualization -->
            <div class="bg-white border border-gray-200 rounded-lg p-4">
                <div class="flex items-center justify-between mb-3">
                    <h4 class="font-medium text-gray-900">üé® Parameter Visualization</h4>
                    <div id="q4-method-indicator" class="text-xs bg-gray-100 px-2 py-1 rounded font-medium">LoRA Method</div>
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Matrix Visualization -->
                    <div>
                        <h5 class="text-sm font-medium text-gray-700 mb-2">Weight Matrix Structure</h5>
                        <div id="q4-matrix-visualization" class="bg-gray-50 rounded-lg p-4 h-48 flex items-center justify-center">
                            <div id="q4-matrix-display" class="grid gap-1"></div>
                        </div>
                        <div id="q4-matrix-legend" class="mt-2 text-xs">
                            <div class="flex flex-wrap gap-3">
                                <span class="inline-flex items-center gap-1">
                                    <span class="w-3 h-3 bg-gray-300 rounded"></span>
                                    Frozen Parameters
                                </span>
                                <span class="inline-flex items-center gap-1">
                                    <span class="w-3 h-3 bg-blue-500 rounded"></span>
                                    Trainable Parameters
                                </span>
                                <span class="inline-flex items-center gap-1">
                                    <span class="w-3 h-3 bg-orange-400 rounded"></span>
                                    Quantized (4-bit)
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Memory & Performance Stats -->
                    <div class="space-y-4">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                            <h6 class="font-medium text-blue-900 mb-2">üíæ Memory Requirements</h6>
                            <div class="text-2xl font-bold text-blue-800" id="q4-memory-value">~50 GB</div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                <div id="q4-memory-bar" class="bg-blue-500 h-2 rounded-full transition-all duration-500" style="width: 20%"></div>
                            </div>
                            <div class="text-xs text-blue-700 mt-1" id="q4-memory-note">GPU Memory Usage</div>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                            <h6 class="font-medium text-green-900 mb-2">‚ö° Training Speed</h6>
                            <div class="text-lg font-bold text-green-800" id="q4-speed-value">3x faster</div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                <div id="q4-speed-bar" class="bg-green-500 h-2 rounded-full transition-all duration-500" style="width: 75%"></div>
                            </div>
                            <div class="text-xs text-green-700 mt-1" id="q4-speed-note">vs Full Fine-tuning</div>
                        </div>
                        
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
                            <h6 class="font-medium text-purple-900 mb-2">üéØ Parameter Efficiency</h6>
                            <div class="text-lg font-bold text-purple-800" id="q4-efficiency-value">99.6% reduction</div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                <div id="q4-efficiency-bar" class="bg-purple-500 h-2 rounded-full transition-all duration-500" style="width: 95%"></div>
                            </div>
                            <div class="text-xs text-purple-700 mt-1" id="q4-efficiency-note">in trainable parameters</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quantization Explorer -->
            <div class="bg-white border border-gray-200 rounded-lg p-4">
                <div class="flex items-center justify-between mb-3">
                    <h4 class="font-medium text-gray-900">üß© Quantization Explorer (4-bit vs 16-bit)</h4>
                    <button id="q4-quant-refresh" class="text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded border border-gray-200 hover:bg-gray-200 transition-colors">Regenerate Sample</button>
                </div>
                <p class="text-xs text-gray-600 mb-3">Visualization of weight values before and after quantization. Left shows full precision (FP16-like), right shows quantized weights (selected bits, default 4-bit NF4-like). Bins are denser near zero to preserve small weights.</p>
                <div class="grid md:grid-cols-3 gap-4 items-start">
                    <div class="md:col-span-2">
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <div class="text-xs text-gray-700 mb-1">Baseline: Full precision</div>
                                <canvas id="q4-quant-matrix-fp16" width="240" height="240" class="border rounded w-full"></canvas>
                            </div>
                            <div>
                                <div id="q4-quant-label" class="text-xs text-gray-700 mb-1">Quantized: 4-bit (NF4-like)</div>
                                <canvas id="q4-quant-matrix-4bit" width="240" height="240" class="border rounded w-full"></canvas>
                            </div>
                        </div>
                        <div class="mt-2 text-[11px] text-gray-600">
                            Why they look similar: 4-bit NF4 keeps most small weights (common in LLMs), so structure is preserved; at this coarse grid and grayscale, per-weight changes are subtle. The histogram and error metrics show the numeric impact, which can accumulate across layers.
                        </div>
                        <div class="mt-3">
                            <div class="text-xs text-gray-700 mb-1">Weight distribution and quantization levels</div>
                            <canvas id="q4-quant-hist" width="520" height="160" class="border rounded w-full"></canvas>
                        </div>
                        <div class="mt-3">
                            <label class="inline-flex items-center gap-2 text-xs text-gray-700">
                                <input id="q4-quant-show-diff" type="checkbox" class="align-middle">
                                Show error heatmap (|full ‚àí quant|)
                            </label>
                            <div class="mt-2 hidden" id="q4-quant-diff-wrap">
                                <canvas id="q4-quant-diff" width="240" height="240" class="border rounded w-full"></canvas>
                                <div class="text-[11px] text-gray-600 mt-1">Redder cells indicate larger per-weight error. This exaggerates tiny differences for visibility.</div>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="bg-blue-50 border border-blue-200 rounded p-2 text-xs">
                            <div class="font-medium text-blue-900">Bits per weight</div>
                            <div id="q4-quant-bits" class="text-blue-800">16 ‚Üí 4 (4x reduction)</div>
                        </div>
                        <div class="bg-green-50 border border-green-200 rounded p-2 text-xs">
                            <div class="font-medium text-green-900">Approx. error</div>
                            <div id="q4-quant-error" class="text-green-800">MSE: ‚Äî, MAE: ‚Äî</div>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 rounded p-2 text-xs">
                            <div class="font-medium text-yellow-900">Note</div>
                            <div class="text-yellow-800">This uses an NF4-like non-uniform codebook (denser near 0) for illustration.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Technical Breakdown -->
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <h4 class="font-medium text-gray-900 mb-3">üìä Technical Breakdown</h4>
                <div id="q4-breakdown" class="grid md:grid-cols-2 gap-4 text-sm">
                    <!-- Content will be populated dynamically -->
                </div>
            </div>
            
            <!-- Practical Scenarios -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <h4 class="font-medium text-yellow-900 mb-3">üéÆ Practical Scenarios</h4>
                <div class="grid md:grid-cols-2 gap-3">
                    <button id="q4-gpu-check" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-800 px-4 py-2 rounded-lg transition-colors text-left">
                        üñ•Ô∏è Check GPU Compatibility
                    </button>
                    <button id="q4-cost-calc" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-800 px-4 py-2 rounded-lg transition-colors text-left">
                        üí∞ Calculate Training Cost
                    </button>
                </div>
                <div id="q4-scenario-output" class="mt-3 p-3 bg-white rounded-lg border hidden">
                    <div class="text-sm"></div>
                </div>
            </div>
            
            <!-- Educational Explanation -->
            <div id="q4-explanation" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <h4 class="font-medium text-yellow-900 mb-2">üìä How It Works</h4>
                <div id="q4-explanation-content" class="text-sm text-yellow-800">
                    Select a fine-tuning method above to see how different approaches balance memory efficiency, training speed, and parameter reduction. Each method represents a different trade-off in the efficiency vs. flexibility spectrum.
                </div>
            </div>
        </div>
