<div class="space-y-6">
      <style>
        /* Explicit styling so active tab always has visible contrast (fallback if class toggling fails) */
        .q51-rail .stage-btn[aria-selected="true"] {
          background:#4f46e5 !important; /* indigo-600 */
          color:#fff !important;
          border-color:#4f46e5 !important;
          box-shadow:0 0 0 1px #4338ca inset,0 1px 2px rgba(0,0,0,.08);
        }
        .q51-rail .stage-btn[aria-selected="true"]:hover { background:#4338ca !important; }
        .q51-rail .stage-btn { transition:background .15s,border-color .15s,color .15s; }
        /* Provide a subtle focus outline for accessibility */
        .q51-rail .stage-btn:focus-visible { outline:2px solid #6366f1; outline-offset:2px; }
      </style>
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200">
        <div class="flex items-center justify-between flex-wrap gap-3 mb-3">
          <label class="block text-sm font-medium text-gray-700">🧪 Lifecycle Flow</label>
          <div id="q51-step-label" class="text-[11px] font-mono px-2 py-0.5 rounded bg-white/70 border border-indigo-200 text-indigo-700"></div>
        </div>
        <!-- Segmented progress bar -->
        <div class="flex items-center gap-1 mb-3" id="q51-progress" aria-hidden="true">
          <span class="flex-1 h-1.5 rounded-full bg-indigo-100 progress-seg"></span><span class="flex-1 h-1.5 rounded-full bg-indigo-100 progress-seg"></span><span class="flex-1 h-1.5 rounded-full bg-indigo-100 progress-seg"></span><span class="flex-1 h-1.5 rounded-full bg-indigo-100 progress-seg"></span><span class="flex-1 h-1.5 rounded-full bg-indigo-100 progress-seg"></span><span class="flex-1 h-1.5 rounded-full bg-indigo-100 progress-seg"></span>
        </div>
        <!-- Horizontal ordered rail with arrows -->
        <div class="q51-rail flex flex-wrap items-center gap-1" role="tablist" aria-label="LLM training lifecycle">
          <button role="tab" data-stage="pretrain" aria-selected="false" title="Massive self-supervised objective builds general priors" class="q51-stage stage-btn px-2.5 py-1 rounded-md text-[11px] font-medium bg-white border border-indigo-200 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors">1. Pre-train</button><span class="text-[10px] text-indigo-400 mx-0.5 select-none" aria-hidden="true">➜</span><button role="tab" data-stage="adapt" aria-selected="false" title="Supervised / PEFT specialization" class="q51-stage stage-btn px-2.5 py-1 rounded-md text-[11px] font-medium bg-white border border-indigo-200 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors">2. Adapt</button><span class="text-[10px] text-indigo-400 mx-0.5 select-none" aria-hidden="true">➜</span><button role="tab" data-stage="align" aria-selected="false" title="Preference optimization (RLHF/DPO)" class="q51-stage stage-btn px-2.5 py-1 rounded-md text-[11px] font-medium bg-white border border-indigo-200 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors">3. Align</button><span class="text-[10px] text-indigo-400 mx-0.5 select-none" aria-hidden="true">➜</span><button role="tab" data-stage="opt" aria-selected="false" title="Latency / cost efficiency improvements" class="q51-stage stage-btn px-2.5 py-1 rounded-md text-[11px] font-medium bg-white border border-indigo-200 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors">4. Optimize</button><span class="text-[10px] text-indigo-400 mx-0.5 select-none" aria-hidden="true">➜</span><button role="tab" data-stage="guard" aria-selected="false" title="Safety & grounding controls" class="q51-stage stage-btn px-2.5 py-1 rounded-md text-[11px] font-medium bg-white border border-indigo-200 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors">5. Guard</button><span class="text-[10px] text-indigo-400 mx-0.5 select-none" aria-hidden="true">➜</span><button role="tab" data-stage="monitor" aria-selected="false" title="Continuous evaluation & feedback" class="q51-stage stage-btn px-2.5 py-1 rounded-md text-[11px] font-medium bg-white border border-indigo-200 hover:bg-indigo-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 transition-colors">6. Monitor</button>
        </div>
        <p class="text-[11px] text-indigo-700 mt-1">Ordered flow from pre-training → monitoring. Use ←/→ or 1–6 keys to navigate. Tooltips give quick intent.</p>
      </div>

      <div class="bg-white border border-gray-200 rounded-lg p-4">
        <div class="flex items-center justify-between mb-3">
          <h4 class="font-medium text-gray-900">📈 Stage Profile</h4>
          <div id="q51-stage-indicator" class="text-xs bg-gray-100 px-2 py-1 rounded font-medium"></div>
        </div>
        <div id="q51-metrics" class="grid grid-cols-2 md:grid-cols-3 gap-4 text-xs"></div>
      </div>

      <div class="bg-white border border-gray-200 rounded-lg p-4">
        <h5 class="font-semibold text-gray-800 mb-2">🧠 Explanation</h5>
        <div id="q51-explain" class="text-xs text-gray-700 space-y-2"></div>
      </div>

      <div class="bg-green-50 border border-green-200 rounded-lg p-4">
        <h5 class="font-semibold text-green-900 mb-1">💡 Insight</h5>
        <div id="q51-insight" class="text-sm text-green-800" aria-live="polite"></div>
      </div>
    </div>
